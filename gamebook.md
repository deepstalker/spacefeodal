# Gamebook SF A2

## Текущая версия (Реализованные механики)

### Управление и исследование
- **ПКМ**: постановка цели перемещения с прямолинейным маршрутом
- **ЛКМ**: выбор целей для боя (враги подсвечиваются красным кругом)
- **Перетаскивание ЛКМ**: панорамирование камеры (drag-to-pan)
- **Колесо мыши**: масштабирование камеры с центрированием
- **F**: переключение режима слежения за кораблём
- **Кинематическое движение**: ускорение, торможение, поворот с учётом инерции
- **Автоматическая остановка**: корабль точно останавливается в целевой точке

### Боевая система
- **Автоматический огонь**: при выборе цели корабль автоматически ведёт огонь
- **Система оружия**: лазеры, пушки, ракеты с разными характеристиками
- **ИИ противников**: агрессивное поведение с поддержанием дистанции
- **Система здоровья**: HP бары, плавающий урон, визуальные эффекты попаданий
- **Баллистика**: упреждающая стрельба с учётом движения цели

### Звёздные системы
- **Множественные системы**: Sol, Beta, Paradise (статические) + процедурная генерация
- **Орбитальная механика**: планеты движутся по круговым орбитам вокруг звезды
- **Точки интереса (POI)**: энкаунтеры активируются при приближении
- **NPC торговцы**: автономные корабли с поведением "планетарный торговец"
- **Процедурная генерация**: системы создаются по профилям с настраиваемыми параметрами

### Визуальная система
- **Многослойный фон**: звёзды и туманности с эффектом параллакса
- **Миникарта**: отображает всю систему, корабль, планеты, POI и область видимости камеры
- **Эффекты**: вспышки при попаданиях, анимации появления/исчезновения
- **Адаптивный интерфейс**: масштабирование под разные разрешения экрана

## Конфигурационная система

### settings.json - Основные настройки
- `resolution.width/height`: целевое разрешение (1920x1080)
- `scaleMode`: режим масштабирования (RESIZE)
- `ui.theme/fontFamily/baseFontSize`: настройки интерфейса
- `camera.minZoom/maxZoom`: пределы масштабирования (0.3-2.5)
- `camera.edgePanMargin/edgePanSpeed`: параметры панорамирования

### gameplay.json - Игровая механика
- `movement.MAX_SPEED`: максимальная скорость (1.0)
- `movement.ACCELERATION/DECELERATION`: ускорение/торможение (0.025/0.08)
- `movement.TURN_SPEED`: скорость поворота (0.02 рад/кадр)
- `movement.SLOWING_RADIUS`: радиус торможения (150)
- `movement.TURN_PENALTY_MULTIPLIER`: штраф за поворот (1.3)
- `dock_range`: дистанция стыковки с планетами (220)

### ships.json - Корабли
- **Типы кораблей**: Explorer (исследователь), Trader (торговец), Fighter (истребитель)
- **Характеристики**: hull (прочность), sprite (внешний вид), combat (боевые параметры)
- **Слоты оружия**: позиции установки оружия на корабле
- **Индивидуальные параметры движения**: каждый тип имеет свои скорости и манёвренность

### weapons.json - Система оружия
- **Laser**: быстрые лазеры (4 выстр/сек, урон 8, дальность 300)
- **Cannon**: пушки (2 выстр/сек, урон 16, дальность 500)  
- **Missile**: ракеты (1 выстр/сек, урон 26, дальность 700)
- **Настройки**: скорость снарядов, эффекты попаданий, смещения дул

### enemies.json & ai_profiles.json - ИИ и враги
- **Профили поведения**: aggressive (агрессивный), static (статичный), planet_trader (торговец)
- **Боевые параметры**: предпочитаемая дистанция, порог отступления
- **Враги**: hostile_ship с лазерами и пушками

### systems.json & system_*.json - Звёздные системы
- **Статические системы**: Sol, Beta, Paradise с уникальными конфигурациями
- **Процедурные системы**: генерация по профилям с настраиваемыми параметрами
- **Параметры планет**: орбиты, скорости вращения, размеры
- **NPC размещение**: торговцы возле планет и звезды

### player.json - Игрок
- **Корабль по умолчанию**: Explorer
- **Стартовое оружие**: laser, cannon, missile
- **Точка старта**: настраиваемая или автоматическая возле звезды

## Менеджеры системы

### ConfigManager
- Загрузка всех JSON конфигураций
- Типобезопасный доступ к настройкам
- Поддержка горячей замены систем

### MovementManager  
- Кинематическая система без физического движка
- Профиль скорости с плавным разгоном/торможением
- Учёт поворотной инерции и штрафов за манёвры

### CombatManager
- Спавн и управление NPC/врагами
- Автоматическая стрельба с упреждением
- Система здоровья и визуальные эффекты
- ИИ поведение (агрессивное, торговое)

### CameraManager
- Режимы слежения и свободной камеры
- Масштабирование с сохранением центра
- Плавные переходы между режимами

### InputManager
- Обработка мыши и клавиатуры
- Drag-to-pan панорамирование
- Разделение левого/правого кликов

### MinimapManager
- Отображение всей системы в миниатюре
- Реальное время: планеты, корабль, POI
- Индикатор области видимости камеры

### SaveManager
- Сохранение позиции и состояния корабля
- Автоматическое восстановление при запуске
- LocalStorage для браузерного сохранения

## Влияние параметров на геймплей

### Движение
- **MAX_SPEED**: влияет на время перелётов между объектами
- **ACCELERATION/DECELERATION**: определяет отзывчивость управления
- **TURN_SPEED**: манёвренность корабля в поворотах
- **SLOWING_RADIUS**: дистанция начала торможения перед целью

### Боевая система
- **Точность корабля**: влияет на эффективность упреждающей стрельбы
- **Скорость снарядов**: определяет сложность уклонения
- **Дальность оружия**: тактические возможности в бою
- **Скорострельность**: DPS и расход боеприпасов

### Системы
- **Размер системы**: время на исследование и перелёты
- **Количество планет**: плотность контента и торговых маршрутов
- **Скорость орбит**: динамичность окружения
- **Количество энкаунтеров**: частота событий

## Последовательность загрузки
1. **BootScene**: инициализация Phaser, подключение плагинов
2. **PreloadScene**: загрузка ассетов с прогресс-баром (rexUI)
3. **StarSystemScene**: основная игровая сцена
4. **UIScene**: интерфейс (миникарта, HUD) - запускается параллельно

## Реализованные возможности
- ✅ Кинематическое движение без физики
- ✅ Боевая система с ИИ
- ✅ Множественные звёздные системы
- ✅ Процедурная генерация
- ✅ NPC торговцы с автономным поведением
- ✅ Миникарта с реальным временем
- ✅ Система сохранений
- ✅ Конфигурационная архитектура
- ✅ Визуальные эффекты и анимации

## Планируемые улучшения
- 🔄 Туман войны и система видимости
- 🔄 Продвинутый A* планировщик маршрутов
- 🔄 Торговая система и экономика
- 🔄 Улучшения кораблей и модификации
- 🔄 Интеграция с LLM для нарративного контента


